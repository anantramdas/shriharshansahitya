<html>
	<head>
		<title>HTML Game</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script src="js/jquery.min.js"></script>
		<style type="text/css">
			html, body {
				margin: 0;
				padding: 0;
				user-select: none;
			}
			@font-face {
			  font-family: kurale;
			  src: url(fonts/Kurale.ttf);
			}
			#frame {
				width: 100%;
				height: 100%;
				background-color: #222;
				font-family: kurale;
			}
			.node, #score {
				position: fixed;
				display: flex;
				justify-content: center;
				align-items: center;
				font-size: 22px;
				font-weight: 500px;
				width: 50px;
				height: 50px;
				border-radius: 50%;
  				background-repeat: no-repeat;
				cursor: pointer;
			}
			#ans {
				position: fixed;
				bottom: 5px;
				left: 15px;
				padding: 5px 8px;
				border-radius: 7px;
				background: white;
				opacity: 0.8;
			}
			.node {
				animation: goTop linear forwards;
			}
			.node.bg0{
				background: radial-gradient(#fff, #ff8ab2);
			}
			.node.bg1{
				background: radial-gradient(#fff, #77c3ff);
			}
			.node.bg2{
				background: radial-gradient(#fceabb, #f8b500);
			}
			.node.bg3{
				background: radial-gradient(#cfcfcf, #fff);
			}
			#score {
				background: radial-gradient(circle 80px, #56ab2f, #a8e063);
				right: 3%;
				top: 30px;
				color: white;
			}
			@keyframes goTop {
				to {top: -100px;}
			}
		</style>
		<script type="text/javascript">
			var nid = 0, score = 0;
			var gems = ['सी', 'ता', 'रा', 'म'];
			var answer = '';
			var dividers, divides = [];
			function onBust(th, index) {
				var userAns = $("#ans");
				if (index == 0) {
					answer = '';
				}
				answer += index;
				if (answer.length > 3) {
					if (answer == '0123') {
						score++;
						$("#score").html(score);
					}
					answer = '';
				}
				var ansHTML = '';
				for (const c of answer) {
					ansHTML += gems[c%4];
				}
				userAns.html(ansHTML);
				$(th).remove();
			}
			function shuffle(array) {
				let counter = array.length;
				while (counter > 0) {
					let index = Math.floor(Math.random() * counter);
					counter--;
					let temp = array[counter];
					array[counter] = array[index];
					array[index] = temp;
				}
				return array;
			}
			function createNode() {
				var h = $(window).height();
				var top = h * 2 / 3 + Math.floor((Math.random() * h / 3));
				var duration = 10 * top/h;
				var index = nid%4;
				if (divides.length == 0) {
					dividers = parseInt($(window).width() / 50);
					divides = Array.from(Array(dividers).keys());
					divides = shuffle(divides);
				}
				var left = divides.pop() * 50;
				$('#frame').append( `<div id='node${nid}' class='node bg${index}' onclick='onBust(this, ${index})' style='animation-duration:${duration}s;top:${top}px;left:${left}px;' z-index=${nid}>${gems[index]}</div>` );
				setTimeout(removeMe,duration * 1000, nid);
				nid++;
			}
			function removeMe(nodeId) {
				$('#node'+nodeId).remove();
			}
			$(document).ready(function(){
				setInterval(createNode, 1200);
			});
		</script>
	</head>
	<body>
		<div id="frame">
		</div>
		<div id="score" z-index="100000">
			0
		</div>
		<div id="ans" z-index="100001"></div>
	</body>
</html>