var init = false;
var Howl = (function(){
	var audioObj;
	var ready = false, isPlaying = false;
	var Howl = function(_audioObj) {
		audioObj = _audioObj;
		audioObj.player.src = audioObj.src;
		if (!init) {
			audioObj.player.addEventListener('play', onplay, false);
			audioObj.player.addEventListener('pause', onpause, false);
			audioObj.player.addEventListener('loadedmetadata', onready, false);
			audioObj.player.addEventListener('timeupdate', audioObj.onseek, false);
			audioObj.player.addEventListener('ended', audioObj.onend, false);
			audioObj.player.addEventListener('waiting', audioObj.onloading, false);
			audioObj.player.addEventListener('playing', audioObj.onplaying, false);
			init = true;
		} else {
			ready = isPlaying = false;
		}
	};

	function onready() {
		ready = true;
		audioObj.onload();
		audioObj.onplay();
	}

	function onpause() {
		isPlaying = false;
		if (ready) {
			audioObj.onpause();
		}
	}

	function onplay() {
		isPlaying = true;
		if (ready) {
			audioObj.onplay();
		}
	}

	Howl.prototype = {
		duration: function() {
			return  audioObj.duration || audioObj.player.duration;
		},
		play: function() {
			audioObj.player.play();
		},
		pause: function() {
			audioObj.player.pause();
		},
		stop: function() {
		},
		state: function() {
			return ready ? 'loaded' : false;
		},
		playing: function() {
			return ready ? 'loaded' : false;
		},
		seek: function(val) {
			if (typeof val != 'undefined') {
				audioObj.player.currentTime = val;
			}
			return audioObj.player.currentTime;
		},
		volume: function() {

		},
	}

	return Howl;
})();